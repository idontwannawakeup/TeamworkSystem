@using TeamworkSystem.WebClient.Interfaces
@page "/signIn"
@layout EmptyLayout
@inject IIdentityService IdentityService

<MudContainer Class="pb-8" MaxWidth="@MaxWidth.Small">
    <MudCard Elevation="4" Class="px-sm-4 px-md-12 px-lg-16 py-sm-4 py-md-6 py-lg-8 mt-4 mt-md-8 mt-lg-16 mx-auto">
        <MudCardContent>
            <MudText Class="mb-xs-4 mb-sm-8 mb-md-16" Typo="@Typo.h4" Align="@Align.Center">Please sign in</MudText>
            <MudTextField T="@string"
                          Class="my-4"
                          Label="UserName"
                          Variant="Variant.Outlined"/>
            <MudTextField T="@string"
                          Class="my-4"
                          Label="Password"
                          Variant="@Variant.Outlined"
                          InputType="@passwordType"
                          Adornment="@Adornment.End"
                          AdornmentIcon="@passwordIcon"
                          OnAdornmentClick="@(e => ChangePasswordIcon())" />
        </MudCardContent>
        <MudCardActions>
            <MudButton Class="mx-auto mt-8 py-2 px-12"
                       Size="@Size.Large"
                       Color="@Color.Primary"
                       Variant="@Variant.Filled"
                       OnClick="@OnSignInClick">
                Sign In
            </MudButton>
        </MudCardActions>
    </MudCard>
</MudContainer>

@code {

    private readonly string showIcon = Icons.Material.Filled.VisibilityOff;

    private readonly string hideIcon = Icons.Material.Filled.Visibility;

    private bool passwordShow = false;

    private InputType passwordType = InputType.Password;

    private string passwordIcon = Icons.Material.Filled.Visibility;

    private void ChangePasswordIcon()
    {
        (passwordType, passwordIcon) = passwordShow
            ? (InputType.Password, hideIcon)
            : (InputType.Text, showIcon);

        passwordShow = !passwordShow;
    }

    private async Task OnSignInClick() =>
        await IdentityService.SignInAsync(new());

}
